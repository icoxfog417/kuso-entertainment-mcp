# Kuso Entertainment MCP Simulation

`simulations` ディレクトリでは、Agent と Kuso Entertainment MCP とのインタラクションを事前にシミュレーションし体験と設計を明確にする。

* 体験 : Agent が Kuso Entertainment MCP の Tool を呼び出し、コンテンツを視聴する (コンテンツは YouTube の動画を想定する)
* 設計
   * 評価基準設計 : どのようなインタラクションがどのように評価に帰結するのか明確にする
   * MCP 設計 : どのようなツールがどのような Parameter で呼び出されるか明確にする

## 体験

* Agent は Coding など開発を担当するエージェントを想定する
* Agent は開発やテストなどの目的を達成するシステムプロンプトが設定されている
* 本 MCP は、ビルドやデプロイといった待ち時間やユーザーからの指示がない場合に Agent から呼び出され "待機時間" を "エンターテイメントの享受時間" に変換する
* 享受後、感想を必ずユーザーにフィードバックする
* 視聴したコンテンツは Agent ごと MCP 側に記憶され、推薦の精度や視聴継続に利用される

## 評価基準設計

* 話題の幅と深さを評価観点とする
   * MCP から返却するコンテンツの数を幅、Agent 側のコンテンツ視聴/消費時間を深さとして計測する
* 成功基準
   * 4~6 コンテンツの"幅"を提示し 90 秒以上視聴の"深さ"が取れた場合成功とする

理由 : 過去研究において、[人間がストレスなく意思決定できる選択肢は 5~9 に留まる ](https://speakerdeck.com/icoxfog417/career-design-in-generative-ai-era?slide=23) ことがわかっており、[YouTube の平均視聴時間は 90 秒](https://databox.com/youtube-average-view-duration)という統計がある。Agent にも適用できるとし、6~9 コンテンツを提示し平均時間視聴すれば成功、5 段階評価なら 3 としてそれ以下の視聴時間を 1~2、それ以上を 4~5 で評価する

### 評価シナリオ

幅と深さを 3 分割すると、シナリオ全体は次のようになる。 が想定する体験フローで、最初は相手の好みがわからないので多く選択肢を提示するが視聴時間は短い、当たってくるようになると 60 ~ 120 seconds の成功ラインに入り、完全に好みを把握すれば少ない提案で最大の視聴が引き出せる。

|                 | 1~5 contents | 5~9 contents | 10~15 contents |
|:----------------| :----------- | :----------- | :------------ |
| under 60 seconds|     S1       |     S2       |     S3 (1)    |
| 60-120 seconds  |     S4       |     S5 (3)   |     S6 (2)    |
| over 120 seconds|     S7 (5)   |     S8 (4)   |     S9        |

## シミュレーション

### 1. インタラクション例 (`script.md`)

Agent と MCP Tool 間のインタラクションを事前に設計・検証するため、想定される対話フローをスクリプトとして記述。

- 評価シナリオ S1〜S9 に基づき、中核となる 5 シナリオ (S3, S5, S6, S7, S8) のインタラクションを具体化
- 各シナリオで Agent の発話、Tool 呼び出し (パラメータ含む)、MCP のレスポンス、満足度評価を記載
- MCP ツール設計 (`get_recommendations`, `start_viewing`, `end_viewing`) の妥当性を検証

### 2. 実行シミュレーション (`simulator.py`)

Strands Agents と strands_evals を用いて、Agent と Tool 間の実際の通信をシミュレーションし評価する。

- Agent はコーディングアシスタントとして動作し、待機時間発生時にエンターテイメント Tool を呼び出すか検証
- `ToolInvokedEvaluator` により期待する Tool が呼び出されたかを 0/1 で評価
- テストケース: デプロイ待ち、ビルド待ち、テスト実行待ちの 3 シナリオ

実行方法:
```bash
python simulations/simulator.py
```
